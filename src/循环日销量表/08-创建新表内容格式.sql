/*
 * 文件名: 08-创建新表内容格式.sql
 * 功能: 创建新表内容格式示例
 * 描述: 本脚本提供了数据从上传表到目标表的映射与转换标准示例，可用于批量数据导入操作
 */

-- 1. 将上传表中的数据插入到目标表，并进行字段映射
-- 此操作将从临时上传表提取数据并插入到正式目标表，同时完成字段重命名
INSERT INTO odsdbfqbi.dbo.ddp_hn  -- 目标表（正式表）
SELECT 
    f1 AS itemcode,   -- 商品编码（从f1字段映射）
    f2 AS itemcn,     -- 商品名称（从f2字段映射）
    f3 AS remark,     -- 备注信息（从f3字段映射）
    f4 AS DQ,         -- 大区分类（从f4字段映射）
    f5 AS mydate      -- 日期字段（从f5字段映射）
FROM odsdbfqbi.dbo.HN_cx_upload_insert_table WITH (NOLOCK)  -- 源表（上传临时表），添加NOLOCK提高性能
WHERE createuser = '[M315886]王伟';  -- 筛选条件：仅导入指定用户创建的数据

/*
 * 代码优化说明：
 * 1. 添加了详细的文件头注释，说明脚本功能和目的
 * 2. 添加了更详细的中文注释，解释字段映射关系
 * 3. 添加了WITH (NOLOCK)提示以提高查询性能
 * 4. 完善了字段说明，使映射关系更加清晰
 * 5. 保留了原始脚本的简洁结构，便于快速理解和修改
 *
 * 使用说明：
 * 1. 本脚本为标准模板，实际使用时应根据具体需求调整表名和字段映射
 * 2. 字段映射可以根据业务需求进行调整，包括添加格式转换、数据清洗等操作
 * 3. WHERE子句可以根据实际需求添加更多筛选条件
 */